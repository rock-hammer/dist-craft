import{C as be,B as Ae,d as C,c as A,o as h,b as ce,aa as W,J as u,x as S,i as c,q as O,D as z,e as M,a4 as K,a2 as $,z as T,ab as xe,l as fe,w as P,a as U,F as j,f as Pe,a5 as Se,a6 as Oe,y as $e}from"./index-692a6cb5.js";import{d as F,e as de,O as H,P as v,Q as X,R as Te,U as ee,T as ne,V as te,W as re,X as L,Y as Ee,b as Be,Z as Y,$ as De,h as Ie,a0 as Le,a1 as Me,a2 as pe,B as E,a3 as Fe,a4 as He,a5 as Ge,a6 as Ne,D as We,a7 as Ue,a8 as qe}from"./file-80c6f74e.js";var ze="[object Symbol]";function Z(e){return typeof e=="symbol"||F(e)&&de(e)==ze}function ge(e,n){for(var t=-1,r=e==null?0:e.length,s=Array(r);++t<r;)s[t]=n(e[t],t,e);return s}var Ke=1/0,ae=H?H.prototype:void 0,se=ae?ae.toString:void 0;function _e(e){if(typeof e=="string")return e;if(v(e))return ge(e,_e)+"";if(Z(e))return se?se.call(e):"";var n=e+"";return n=="0"&&1/e==-Ke?"-0":n}function Xe(e){return e}var Ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ze=/^\w*$/;function J(e,n){if(v(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||Z(e)?!0:Ze.test(e)||!Ye.test(e)||n!=null&&e in Object(n)}var Je="Expected a function";function Q(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new TypeError(Je);var t=function(){var r=arguments,s=n?n.apply(this,r):r[0],a=t.cache;if(a.has(s))return a.get(s);var i=e.apply(this,r);return t.cache=a.set(s,i)||a,i};return t.cache=new(Q.Cache||X),t}Q.Cache=X;var Qe=500;function Ve(e){var n=Q(e,function(r){return t.size===Qe&&t.clear(),r}),t=n.cache;return n}var ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/\\(\\)?/g,en=Ve(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(ke,function(t,r,s,a){n.push(s?a.replace(je,"$1"):r||t)}),n});const nn=en;function tn(e){return e==null?"":_e(e)}function me(e,n){return v(e)?e:J(e,n)?[e]:nn(tn(e))}var rn=1/0;function N(e){if(typeof e=="string"||Z(e))return e;var n=e+"";return n=="0"&&1/e==-rn?"-0":n}function ye(e,n){n=me(n,e);for(var t=0,r=n.length;e!=null&&t<r;)e=e[N(n[t++])];return t&&t==r?e:void 0}function x(e,n,t){var r=e==null?void 0:ye(e,n);return r===void 0?t:r}var an="__lodash_hash_undefined__";function sn(e){return this.__data__.set(e,an),this}function on(e){return this.__data__.has(e)}function G(e){var n=-1,t=e==null?0:e.length;for(this.__data__=new X;++n<t;)this.add(e[n])}G.prototype.add=G.prototype.push=sn;G.prototype.has=on;function ln(e,n){for(var t=-1,r=e==null?0:e.length;++t<r;)if(n(e[t],t,e))return!0;return!1}function un(e,n){return e.has(n)}var cn=1,fn=2;function he(e,n,t,r,s,a){var i=t&cn,o=e.length,l=n.length;if(o!=l&&!(i&&l>o))return!1;var d=a.get(e),g=a.get(n);if(d&&g)return d==n&&g==e;var p=-1,f=!0,y=t&fn?new G:void 0;for(a.set(e,n),a.set(n,e);++p<o;){var _=e[p],m=n[p];if(r)var w=i?r(m,_,p,n,e,a):r(_,m,p,e,n,a);if(w!==void 0){if(w)continue;f=!1;break}if(y){if(!ln(n,function(R,b){if(!un(y,b)&&(_===R||s(_,R,t,r,a)))return y.push(b)})){f=!1;break}}else if(!(_===m||s(_,m,t,r,a))){f=!1;break}}return a.delete(e),a.delete(n),f}function dn(e){var n=-1,t=Array(e.size);return e.forEach(function(r,s){t[++n]=[s,r]}),t}function pn(e){var n=-1,t=Array(e.size);return e.forEach(function(r){t[++n]=r}),t}var gn=1,_n=2,mn="[object Boolean]",yn="[object Date]",hn="[object Error]",vn="[object Map]",wn="[object Number]",Cn="[object RegExp]",Rn="[object Set]",bn="[object String]",An="[object Symbol]",xn="[object ArrayBuffer]",Pn="[object DataView]",oe=H?H.prototype:void 0,q=oe?oe.valueOf:void 0;function Sn(e,n,t,r,s,a,i){switch(t){case Pn:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case xn:return!(e.byteLength!=n.byteLength||!a(new ee(e),new ee(n)));case mn:case yn:case wn:return Te(+e,+n);case hn:return e.name==n.name&&e.message==n.message;case Cn:case bn:return e==n+"";case vn:var o=dn;case Rn:var l=r&gn;if(o||(o=pn),e.size!=n.size&&!l)return!1;var d=i.get(e);if(d)return d==n;r|=_n,i.set(e,n);var g=he(o(e),o(n),r,s,a,i);return i.delete(e),g;case An:if(q)return q.call(e)==q.call(n)}return!1}var On=1,$n=Object.prototype,Tn=$n.hasOwnProperty;function En(e,n,t,r,s,a){var i=t&On,o=ne(e),l=o.length,d=ne(n),g=d.length;if(l!=g&&!i)return!1;for(var p=l;p--;){var f=o[p];if(!(i?f in n:Tn.call(n,f)))return!1}var y=a.get(e),_=a.get(n);if(y&&_)return y==n&&_==e;var m=!0;a.set(e,n),a.set(n,e);for(var w=i;++p<l;){f=o[p];var R=e[f],b=n[f];if(r)var k=i?r(b,R,f,n,e,a):r(R,b,f,e,n,a);if(!(k===void 0?R===b||s(R,b,t,r,a):k)){m=!1;break}w||(w=f=="constructor")}if(m&&!w){var B=e.constructor,D=n.constructor;B!=D&&"constructor"in e&&"constructor"in n&&!(typeof B=="function"&&B instanceof B&&typeof D=="function"&&D instanceof D)&&(m=!1)}return a.delete(e),a.delete(n),m}var Bn=1,ie="[object Arguments]",le="[object Array]",I="[object Object]",Dn=Object.prototype,ue=Dn.hasOwnProperty;function In(e,n,t,r,s,a){var i=v(e),o=v(n),l=i?le:te(e),d=o?le:te(n);l=l==ie?I:l,d=d==ie?I:d;var g=l==I,p=d==I,f=l==d;if(f&&re(e)){if(!re(n))return!1;i=!0,g=!1}if(f&&!g)return a||(a=new L),i||Ee(e)?he(e,n,t,r,s,a):Sn(e,n,l,t,r,s,a);if(!(t&Bn)){var y=g&&ue.call(e,"__wrapped__"),_=p&&ue.call(n,"__wrapped__");if(y||_){var m=y?e.value():e,w=_?n.value():n;return a||(a=new L),s(m,w,t,r,a)}}return f?(a||(a=new L),En(e,n,t,r,s,a)):!1}function V(e,n,t,r,s){return e===n?!0:e==null||n==null||!F(e)&&!F(n)?e!==e&&n!==n:In(e,n,t,r,V,s)}var Ln=1,Mn=2;function Fn(e,n,t,r){var s=t.length,a=s,i=!r;if(e==null)return!a;for(e=Object(e);s--;){var o=t[s];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++s<a;){o=t[s];var l=o[0],d=e[l],g=o[1];if(i&&o[2]){if(d===void 0&&!(l in e))return!1}else{var p=new L;if(r)var f=r(d,g,l,e,n,p);if(!(f===void 0?V(g,d,Ln|Mn,r,p):f))return!1}}return!0}function ve(e){return e===e&&!Be(e)}function Hn(e){for(var n=Y(e),t=n.length;t--;){var r=n[t],s=e[r];n[t]=[r,s,ve(s)]}return n}function we(e,n){return function(t){return t==null?!1:t[e]===n&&(n!==void 0||e in Object(t))}}function Gn(e){var n=Hn(e);return n.length==1&&n[0][2]?we(n[0][0],n[0][1]):function(t){return t===e||Fn(t,e,n)}}function Nn(e,n){return e!=null&&n in Object(e)}function Wn(e,n,t){n=me(n,e);for(var r=-1,s=n.length,a=!1;++r<s;){var i=N(n[r]);if(!(a=e!=null&&t(e,i)))break;e=e[i]}return a||++r!=s?a:(s=e==null?0:e.length,!!s&&De(s)&&Ie(i,s)&&(v(e)||Le(e)))}function Un(e,n){return e!=null&&Wn(e,n,Nn)}var qn=1,zn=2;function Kn(e,n){return J(e)&&ve(n)?we(N(e),n):function(t){var r=x(t,e);return r===void 0&&r===n?Un(t,e):V(n,r,qn|zn)}}function Xn(e){return function(n){return n==null?void 0:n[e]}}function Yn(e){return function(n){return ye(n,e)}}function Zn(e){return J(e)?Xn(N(e)):Yn(e)}function Jn(e){return typeof e=="function"?e:e==null?Xe:typeof e=="object"?v(e)?Kn(e[0],e[1]):Gn(e):Zn(e)}function Qn(e){return function(n,t,r){for(var s=-1,a=Object(n),i=r(n),o=i.length;o--;){var l=i[e?o:++s];if(t(a[l],l,a)===!1)break}return n}}var Vn=Qn();const kn=Vn;function jn(e,n){return e&&kn(e,n,Y)}var et="[object String]";function nt(e){return typeof e=="string"||!v(e)&&F(e)&&de(e)==et}function tt(e,n){return ge(n,function(t){return e[t]})}function rt(e){return e==null?[]:tt(e,Y(e))}function at(e,n){var t={};return n=Jn(n),jn(e,function(r,s,a){Me(t,s,n(r,s,a))}),t}function jt(e,n,t){t<0||t>=e.length||e.splice(t,0,e.splice(n,1)[0])}function st(e,n){const t=n?x(e,n):e;return v(t)&&t.length>0}function ot(e){return!!e&&e.some(n=>Ce(n))}function Ce(e){return!e||e.type===be||e.type===Ae&&(!nt(e.children)||e.children.trim()==="")?!1:e.children&&Array.isArray(e.children)?e.children.some(n=>Ce(n)):!0}const it="DemoA",lt="演示组件 DemoA",ut="/cover/default.png",ct="./components-async/DemoA/Main.vue",ft=Object.freeze(Object.defineProperty({__proto__:null,cover:ut,name:it,path:ct,title:lt},Symbol.toStringTag,{value:"Module"})),dt="DemoB",pt="演示组件 DemoB",gt="/cover/default.png",_t="./components-async/DemoB/Main.vue",mt=Object.freeze(Object.defineProperty({__proto__:null,cover:gt,name:dt,path:_t,title:pt},Symbol.toStringTag,{value:"Module"})),yt="ImageRender",ht="图片",vt="/cover/default.png",wt="./components-async/ImageRender/Main.vue",Ct=Object.freeze(Object.defineProperty({__proto__:null,cover:vt,name:yt,path:wt,title:ht},Symbol.toStringTag,{value:"Module"})),Rt={class:"flex items-center justify-center w-full h-full p-2 bg-indigo-500 rounded"},bt=ce("span",{class:"block text-4xl text-white i-icon-park-outline-game-ps"},null,-1),At=[bt],xt=C({name:"DemoPlay",__name:"Main",setup(e){return(n,t)=>(h(),A("div",Rt,At))}}),Pt="DemoPlay",St="演示组件 DemoPlay",Ot="/cover/default.png",$t=Object.freeze(Object.defineProperty({__proto__:null,component:xt,cover:Ot,name:Pt,title:St},Symbol.toStringTag,{value:"Module"})),Tt=Object.assign({"./components-async/DemoA/Main.vue":()=>W(()=>import("./Main-aed8f6f2.js"),["assets/Main-aed8f6f2.js","assets/index-692a6cb5.js","assets/index-b85c89ca.css"]),"./components-async/DemoB/Main.vue":()=>W(()=>import("./Main-a51ec9a0.js"),["assets/Main-a51ec9a0.js","assets/index-692a6cb5.js","assets/index-b85c89ca.css"]),"./components-async/ImageRender/Main.vue":()=>W(()=>import("./Main-bc40be7f.js"),["assets/Main-bc40be7f.js","assets/index-692a6cb5.js","assets/index-b85c89ca.css"])}),Et=Object.assign({"./components-async/DemoA/define.ts":ft,"./components-async/DemoB/define.ts":mt,"./components-async/ImageRender/define.ts":Ct}),Bt=rt(Et).map(e=>({componentLoader:Tt[e.path],cover:e.cover,name:e.name,title:e.title})),er=[...Bt,$t];const Dt=C({name:"CraftRenderBoxContentPlaceholder",__name:"CraftRenderBoxContentPlaceholder",props:{color:{default:pe.gray[600]}},setup(e){const n=e,t=E({bottom:0,left:0,position:"absolute",right:0,top:0}),r=u(()=>({backgroundColor:n.color}));return(s,a)=>(h(),A("div",{class:S(c(t)),style:O(r.value)},null,6))}});function It(e,{wrapperRef:n,containerRef:t}){const r=u(()=>{let o=1;switch(e.data.props.fit){case"height":o=e.sceneHeight/e.data.height;break;case"width":o=e.sceneWidth/e.data.width;break;case"contain":o=Math.min(e.sceneWidth/e.data.width,e.sceneHeight/e.data.height);break;case"cover":o=Math.max(e.sceneWidth/e.data.width,e.sceneHeight/e.data.height);break;case"source":o=1;break}return o}),s=u(()=>e.data.height*r.value),a=u(()=>e.data.width*r.value);return{containerRef:t,data:u(()=>e.data),displayHeight:s,displayWidth:a,scale:r,sceneHeight:u(()=>e.sceneHeight),sceneWidth:u(()=>e.sceneWidth),wrapperRef:n}}function Lt(e){const n=E({alignItems:"center",display:"flex",justifyContent:"center"}),t=u(()=>({height:`${e.displayHeight.value}px`,width:`${e.displayWidth.value}px`})),r=E({flexGrow:0,flexShrink:0,position:"relative"}),s=u(()=>({...Fe({boardProps:e.data.value.props}),height:`${e.data.value.height}px`,transform:`scale(${e.scale.value})`,transformOrigin:"center center",width:`${e.data.value.width}px`}));return z({containerClass:r,containerStyle:s,wrapperClass:n,wrapperStyle:t})}const Mt={};function Ft(e){const n=M(),t=M(),r=It(e,{containerRef:t,wrapperRef:n}),s=Lt(r);return{containerRef:t,state:r,style:s,wrapperRef:n}}const Ht=C({name:"CraftRenderBoard",__name:"CraftRenderBoard",props:K({data:{},sceneHeight:{},sceneWidth:{}},Mt),setup(e,{expose:n}){const t=e,{wrapperRef:r,containerRef:s,style:a,state:i}=Ft(t);return n({state:i}),(o,l)=>(h(),A("div",{ref_key:"wrapperRef",ref:r,class:S(c(a).wrapperClass),style:O(c(a).wrapperStyle)},[ce("div",{ref_key:"containerRef",ref:s,class:S(c(a).containerClass),style:O(c(a).containerStyle)},[$(o.$slots,"default")],6)],6))}});function Gt(e,{wrapperRef:n}){return{data:u(()=>e.data),wrapperRef:n}}function Nt(e){const n=E({position:"absolute"}),t=u(()=>({height:`${e.data.value.height}px`,left:`${e.data.value.left}px`,top:`${e.data.value.top}px`,width:`${e.data.value.width}px`}));return z({wrapperClass:n,wrapperStyle:t})}const Wt={};function Ut(e){const n=M(),t=Gt(e,{wrapperRef:n}),r=Nt(t);return{state:t,style:r,wrapperRef:n}}const qt=C({name:"CraftRenderBox",__name:"CraftRenderBox",props:K({data:{}},Wt),setup(e,{expose:n}){const t=e,{wrapperRef:r,style:s,state:a}=Ut(t);return n({state:a}),(i,o)=>(h(),A("div",{ref_key:"wrapperRef",ref:r,class:S(c(s).wrapperClass),style:O(c(s).wrapperStyle)},[$(i.$slots,"default")],6))}}),zt=C({name:"CraftRenderBoxContentItem",props:{components:{required:!0,type:Array},config:{required:!0,type:Object}},setup(e){const n=u(()=>x(e.config,"name","")),t=u(()=>x(e.config,"props",{})),r=u(()=>x(e.config,"slots")),s=u(()=>{if(e.config){const o=e.components.find(l=>l.name===n.value);if(o){const l=o.componentLoader;if(He(l))return l}}return null}),a=u(()=>{if(e.config){const o=e.components.find(l=>l.name===n.value);if(o){const l=o.component;if(l)return l}}return null}),i=u(()=>{if(s.value){const o=s.value;return xe(()=>o())}else return null});return()=>{const o=Re({components:e.components,slots:r.value});return s.value?T(i.value,t.value,o):a.value?T(a.value,t.value,o):null}}});function Re({slots:e,components:n}){let t={};return e&&(t=at(e,r=>()=>r.map(s=>T(zt,{components:n,config:s})))),t}const Kt=C({name:"CraftRenderBoxContent",props:{box:{required:!0,type:Object},components:{required:!0,type:Array}},setup(e,{slots:n}){const t=u(()=>x(e.box,"slots")),r=u(()=>Ge(t.value)&&Object.keys(t.value).some(a=>st(t.value[a]))),s=u(()=>Ne({boxProps:e.box.props}));return()=>{var i;const a=(i=n.box)==null?void 0:i.call(n,{box:e.box,id:e.box.id,name:e.box.props.name});return T("div",{class:"absolute inset-0",style:s.value},ot(a)?a:r.value?Re({components:e.components,slots:t.value}):T(Dt,{color:e.box.props.placeholderColor}))}},slots:Object}),Xt=C({name:"CraftRenderScrollbar",__name:"CraftRenderScrollbar",props:{active:{type:Boolean,default:!1}},setup(e){return(n,t)=>n.active?(h(),fe(c(We),{key:0},{default:P(()=>[$(n.$slots,"default")]),_:3})):$(n.$slots,"default",{key:1})}});function Yt(e,{wrapperRef:n}){const{width:t,height:r}=Ue(n);function s(o){e.inspect&&console.log(o)}const a=u(()=>{let o=!1;return e.data.scene.props.overflow==="scroll"&&e.data.board.props.alignment==="none"&&(o=!0),o});return{components:u(()=>e.components),data:u(()=>e.data),inspect:u(()=>e.inspect),onDoubleClickBox:s,sceneHeight:r,sceneWidth:t,scrollbar:a,wrapperRef:n}}function Zt(e){const n=E({backgroundColor:pe.gray[100],height:"100%",overflow:"hidden",position:"relative",width:"100%"}),t=u(()=>qe({boardProps:e.data.value.board.props,sceneProps:e.data.value.scene.props}));return z({wrapperClass:n,wrapperStyle:t})}const Jt={components:()=>[],inspect:!1};function Qt(e){const n=M(),t=Yt(e,{wrapperRef:n}),r=Zt(t);return{state:t,style:r,wrapperRef:n}}const nr=C({name:"CraftRender",__name:"CraftRender",props:K({data:{},components:{},inspect:{type:Boolean}},Jt),setup(e,{expose:n}){const t=e,{wrapperRef:r,style:s,state:a}=Qt(t);return n({state:a}),(i,o)=>(h(),A("div",{ref_key:"wrapperRef",ref:r,class:S(c(s).wrapperClass),style:O(c(s).wrapperStyle)},[U(c(Xt),{active:c(a).scrollbar.value},{default:P(()=>[U(c(Ht),{data:c(a).data.value.board,"scene-height":c(a).sceneHeight.value,"scene-width":c(a).sceneWidth.value},{default:P(()=>[(h(!0),A(j,null,Pe(c(a).data.value.boxes,l=>(h(),A(j,{key:l.id},[l.props.visible?(h(),fe(c(qt),{key:0,data:l,onDblclick:()=>c(a).onDoubleClickBox(l)},{default:P(()=>[U(c(Kt),{box:l,components:c(a).components.value},{box:P(d=>[$(i.$slots,"box",Se(Oe(d)))]),_:2},1032,["box","components"])]),_:2},1032,["data","onDblclick"])):$e("",!0)],64))),128))]),_:3},8,["data","scene-height","scene-width"])]),_:3},8,["active"])],6))}});export{Kt as C,G as S,nr as _,un as a,V as b,me as c,er as d,x as g,Z as i,jt as m,st as n,pn as s,N as t};
